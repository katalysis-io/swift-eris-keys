//
//  ViewController.swift
//  ErisKeys
//
//  Created by Alex Tran Qui on 07/14/2016.
//  Copyright (c) 2016 Alex Tran Qui. All rights reserved.
//

import UIKit
import ErisKeys

class ViewController: UIViewController {

    override func viewDidLoad() {
        super.viewDidLoad()
        // Do any additional setup after loading the view, typically from a nib.
      
      let privKS1: [byte] = [0x19,0x8C,0x02,0xC9,0xE2,0xA9,0x38,0xE8,0x55,0xF8,0x25,0xB3,0xB0,0xDB,0x06,0xD5,0xD8,0xA1,0xC5,0x2A,0xE4,0xB6,0xA2,0x93,0x4B,0x50,0xDC,0xFB,0xB0,0x89,0xE7,0x99]
      
      var ek1 = ErisKey(seed: privKS1)
      
      print (ek1.pubKey().toString())
      print (ek1.account())
      
      let message: [byte] = [0xD0,0x0A,0xC3,0x26,0x76,0x6F,0x69,0x63,0x69,0x20,0x75,0x6E,0x20,0x74,0x65,0x78,0x74,0x65,0x20,0x64,0x65,0x20,0x33,0x32,0x20,0x63,0x68,0x61,0x72,0x61,0x63,0x74,0x65,0x72,0x65,0x73,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF2,0x14,0x9A,0x1E,0xC4,0x94,0xD9,0x46,0x58,0x1A,0xC4,0x53,0x21,0xA0,0xE5,0x45,0x57,0x3D,0x2C,0x4C]
      
      let sig = ek1.sign(message)
      
      
      print (sig.toString())
      if (Verify(ek1.pubKey(), message, sig)) {
        print("hurra, the signature is verified!")
      } else {
        print("booh, the signature is incorrect!")
      }

      
      
    }

    override func didReceiveMemoryWarning() {
        super.didReceiveMemoryWarning()
        // Dispose of any resources that can be recreated.
    }

}

